<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Dealing with Hooks &#8212; cozy 1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <script src="_static/documentation_options.js?v=56dcb7b8"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modeling I/O Side Effects" href="sideeffects.html" />
    <link rel="prev" title="Using Concolic Execution" href="concolic.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dealing-with-hooks">
<h1>Dealing with Hooks<a class="headerlink" href="#dealing-with-hooks" title="Link to this heading">¶</a></h1>
<p>Some of the default C library hooks provided by angr will not function properly with
comparitive symbolic execution, including joint concolic execution. The issue stems
from two different factors:</p>
<p>1. Hooks may provide an incomplete implementation of the C library hooks, or the complete
implementation may be disabled by default. For example, the <code class="docutils literal notranslate"><span class="pre">strtok_r</span></code> function’s
more complete implementation may be disabled by default, and should be enabled by setting
<code class="xref py py-attr docutils literal notranslate"><span class="pre">angr.SimState.libc.simple_strtok</span></code> to False. Likewise the <code class="docutils literal notranslate"><span class="pre">strstr</span></code> libc function
has a configuration option <code class="xref py py-attr docutils literal notranslate"><span class="pre">angr.SimState.libc.max_symbolic_strstr</span></code> which is by
default set to a very conservative value of 1.</p>
<p>2. The default angr hooks create fresh symbolic variables, and constrain these symbolic
values by adding to the state’s constraints. This is problematic since in comparitive
symbolic execution we assume that both programs are fed the same symbolic variables.
Fortunately it is possible to eliminate the fresh symbolic variables in most cases. To see
an example of how to do this, see our provided replacement hook for <code class="docutils literal notranslate"><span class="pre">strlen</span></code> at
<a class="reference internal" href="autoapi/cozy/hooks/strlen/index.html#cozy.hooks.strlen.strlen" title="cozy.hooks.strlen.strlen"><code class="xref py py-class docutils literal notranslate"><span class="pre">cozy.hooks.strlen.strlen</span></code></a>.</p>
<p>In general, the best strategy for dealing with hooks is to be aware of their limitations,
understand the configuration options found in <code class="xref py py-attr docutils literal notranslate"><span class="pre">angr.SimState.libc</span></code>, and replace
the default hooks when needed.</p>
<p>To replace a hook for a specific project, you may use the
<a class="reference internal" href="autoapi/cozy/project/index.html#cozy.project.Project.hook_symbol" title="cozy.project.Project.hook_symbol"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cozy.project.Project.hook_symbol()</span></code></a> method.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">cozy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="launchingavisualization.html">Launching a Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="concolic.html">Using Concolic Execution</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dealing with Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="sideeffects.html">Modeling I/O Side Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="underconstrained.html">Underconstrained Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="concolic.html" title="previous chapter">Using Concolic Execution</a></li>
      <li>Next: <a href="sideeffects.html" title="next chapter">Modeling I/O Side Effects</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, The Charles Stark Draper Laboratory.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/hooks.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>