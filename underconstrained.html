<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Underconstrained Execution &#8212; cozy 1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <script src="_static/documentation_options.js?v=56dcb7b8"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="autoapi/index.html" />
    <link rel="prev" title="Modeling I/O Side Effects" href="sideeffects.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="underconstrained-execution">
<h1>Underconstrained Execution<a class="headerlink" href="#underconstrained-execution" title="Link to this heading">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Underconstrained symbolic execution is currently an experimental feature and may
not be as stable as typical symbolic execution.</p>
</div>
<p>Underconstrained symbolic execution is a symbol creation and management strategy
that enables execution that requires a minimal amount of set up. In ordinary cozy
symbolic execution, harnesses must be written to set up the input for the programs
being tested. These harnesses can be tedious to write, and require some reverse
engineering effort to write. Underconstrained execution drastically cuts down
on harness creation time.</p>
<p>In underconstrained execution, the initial registers and memory are entirely symbolic.
This means that setting up the arguments and related data structures is not required.
For simple cases this is fine, however in some scenarios constraints on inputs
are required to ensure that program execution is finite. For these scenarios
underconstrained execution is not suitable.</p>
<p>Let’s take a look at some examples of how to use underconstrained symbolic execution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sess_prepatched</span> <span class="o">=</span> <span class="n">proj_prepatched</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="s1">&#39;my_fun&#39;</span><span class="p">,</span> <span class="n">underconstrained_execution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results_prepatched</span> <span class="o">=</span> <span class="n">sess_prepatched</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">sess_postpatched</span> <span class="o">=</span> <span class="n">proj_postpatched</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="s1">&#39;my_fun&#39;</span><span class="p">,</span> <span class="n">underconstrained_execution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">underconstrained_initial_state</span><span class="o">=</span><span class="n">results_prepatched</span><span class="o">.</span><span class="n">underconstrained_machine_state</span><span class="p">)</span>
<span class="n">results_postpatched</span> <span class="o">=</span> <span class="n">sess_postpatched</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">comparison</span> <span class="o">=</span> <span class="n">cozy</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">Comparison</span><span class="p">(</span><span class="n">results_prepatched</span><span class="p">,</span> <span class="n">results_postpatched</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is a summary of the new features that are used for underconstrained execution:</p>
<ol class="arabic simple">
<li><p>We must enable underconstrained execution by setting <cite>underconstrained_execution</cite> to <cite>True</cite> when creating a <a class="reference internal" href="autoapi/cozy/project/index.html#cozy.project.Project.session" title="cozy.project.Project.session"><code class="xref py py-meth docutils literal notranslate"><span class="pre">session()</span></code></a>.</p></li>
<li><p>We do not pass any arguments to the <a class="reference internal" href="autoapi/cozy/session/index.html#cozy.session.Session.run" title="cozy.session.Session.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> method. The underconstrained initial registers and memory allows the execution to evaluate all possible input values.</p></li>
<li><p>When we create the second session, we must pass the machine state from the first session by passing a <a class="reference internal" href="autoapi/cozy/session/index.html#cozy.session.UnderconstrainedMachineState" title="cozy.session.UnderconstrainedMachineState"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnderconstrainedMachineState</span></code></a> object. This object is easily obtained by getting it from the <cite>underconstrained_machine_state</cite> property from the <a class="reference internal" href="autoapi/cozy/session/index.html#cozy.session.RunResult" title="cozy.session.RunResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunResult</span></code></a> of the previous execution. The <a class="reference internal" href="autoapi/cozy/session/index.html#cozy.session.UnderconstrainedMachineState" title="cozy.session.UnderconstrainedMachineState"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnderconstrainedMachineState</span></code></a> object is used to ensure that the initial symbolic registers and memory layout is the same between the two executions.</p></li>
</ol>
<p>Underconstrained execution employs concretization strategies to concretize symbolic pointers
and symbolic arrays. The strategy employed is based off of the angr
<code class="xref py py-class docutils literal notranslate"><span class="pre">angr.concretization_strategies.SimConcretizationStrategyNorepeatsRange</span></code> strategy.
In this strategy, pointers that are symbolic are concretized to fresh areas of memory. This
strategy makes the assumption that pointers shouldn’t be aliasing and can in fact point to
different data structures. Pointers for arrays likewise will be concretized to a contiguous
fresh chunk of memory.</p>
<p>This introduces an initial difficulty to diff analysis. Since these fresh chunks of memory are
allocated as needed (on demand), memory layout between two runs needs to be consistent for the comparison
process. This is why an <cite>underconstrained_initial_state</cite> must be passed to the second session’s
run.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">cozy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="launchingavisualization.html">Launching a Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="concolic.html">Using Concolic Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks.html">Dealing with Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="sideeffects.html">Modeling I/O Side Effects</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Underconstrained Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="sideeffects.html" title="previous chapter">Modeling I/O Side Effects</a></li>
      <li>Next: <a href="autoapi/index.html" title="next chapter">API Reference</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, The Charles Stark Draper Laboratory.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/underconstrained.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>